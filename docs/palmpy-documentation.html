<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>palmpy-documentation</title><link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 40px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 2; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 32px; padding-right: 32px; padding-bottom: 0px; break-after: avoid; }
  .typora-export #write::after { height: 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none 0s ease 0s; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
svg[id^="mermaidChart"] { line-height: 1em; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
mark .md-meta { color: rgb(0, 0, 0); opacity: 0.3 !important; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

html {
    font-size: 16px;
}

body {
    font-family: "Open Sans","Clear Sans","Helvetica Neue",Helvetica,Arial,sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}
#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    padding-bottom: .3em;
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
   padding-bottom: .3em;
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}
h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table tr th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table tr td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table tr th:first-child,
table tr td:first-child {
    margin-top: 0;
}
table tr th:last-child,
table tr td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}


</style>
</head>
<body class='typora-export os-windows' >
<div  id='write'  class = 'is-node'><header>
    <font size="+3"><b>palmpy Framework 1.0 Documentation</b></font>
</header><p><strong><span>Table of Contents</span></strong></p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n6"><a class="md-toc-inner" href="#introduction">Introduction</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n31"><a class="md-toc-inner" href="#applied-paradigms---how-it-works">Applied Paradigms - how it works</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n50"><a class="md-toc-inner" href="#palmpy-description">Palmpy Description</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n53"><a class="md-toc-inner" href="#geodatatools"><em>geodatatools</em></a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n55"><a class="md-toc-inner" href="#makestatictools"><em>makestatictools</em></a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n57"><a class="md-toc-inner" href="#mapdicts"><em>mapdicts</em></a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n59"><a class="md-toc-inner" href="#installation-of-palmpy">Installation of palmpy</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n60"><a class="md-toc-inner" href="#python-environment">Python Environment</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n108"><a class="md-toc-inner" href="#a-word-on-environments-and-packages">A Word on Environments and Packages</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n112"><a class="md-toc-inner" href="#package-installation">Package Installation</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n120"><a class="md-toc-inner" href="#basic-usage">Basic Usage</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n129"><a class="md-toc-inner" href="#create-a-palm-static-driver-using-palmpy">Create a PALM Static driver using palmpy</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n130"><a class="md-toc-inner" href="#qgis-input-file-preparation">QGIS Input File Preparation</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n132"><a class="md-toc-inner" href="#paradigms-and-standards">Paradigms and Standards</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n135"><a class="md-toc-inner" href="#rastered-data">Rastered Data</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n137"><a class="md-toc-inner" href="#topography">Topography</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n139"><a class="md-toc-inner" href="#surface-classification">Surface Classification</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n142"><a class="md-toc-inner" href="#shapefiles">Shapefiles</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n145"><a class="md-toc-inner" href="#resolved-vegetation">Resolved Vegetation</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n147"><a class="md-toc-inner" href="#pavement--sealed-surfaces">Pavement / Sealed Surfaces</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n149"><a class="md-toc-inner" href="#crops">Crops</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n171"><a class="md-toc-inner" href="#buildings">Buildings</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n175"><a class="md-toc-inner" href="#static-file-generation-script">Static File Generation Script</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n177"><a class="md-toc-inner" href="#script">Script</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n183"><a class="md-toc-inner" href="#namelist">Namelist</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n459"><a class="md-toc-inner" href="#hints-regarding-domain-creation">Hints Regarding Domain Creation</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n460"><a class="md-toc-inner" href="#grid-dimensions">Grid Dimensions</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n518"><a class="md-toc-inner" href="#further-information">Further Information</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n519"><a class="md-toc-inner" href="#dynamic-driver-generation-with-inifor">Dynamic Driver Generation with INIFOR</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n523"><a class="md-toc-inner" href="#cosmo2inifor">cosmo2inifor</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n554"><a class="md-toc-inner" href="#inifor">INIFOR</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n573"><a class="md-toc-inner" href="#vapor-visualization">VAPOR Visualization</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n580"><a class="md-toc-inner" href="#palm-simulation-lessons-learned">PALM Simulation Lessons Learned</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n600"><a class="md-toc-inner" href="#useful-code-snippets">Useful Code Snippets</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n601"><a class="md-toc-inner" href="#castor--pollux-cluster">Castor / Pollux Cluster</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n612"><a class="md-toc-inner" href="#nco">NCO</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n615"><a class="md-toc-inner" href="#cdo">CDO</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n622"><a class="md-toc-inner" href="#gis--gdal">GIS / GDAL</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n642"><a class="md-toc-inner" href="#glossary">Glossary</a></span></p></div><hr /><div style="page-break-after: always; break-after: page;"></div><h1><a name="introduction" class="md-header-anchor"></a><span>Introduction</span></h1><p><span>Welcome to palmpy! This package will help you create static files for your PALM simulation. It contains various elements that deal with certain aspects of handling data for PALM, initially built around geodata products by swisstopo (</span><em><span>swissALTI3D, swissTLM3D</span></em><span>) and expanded since. Palmpy assists you in the following tasks:</span></p><ul><li><p><span>input data processing</span></p><ul><li><span>raster data and shapefiles -&gt; _static files</span></li><li><span>COSMO data preprocessor scripts to make them usable with INIFOR</span></li></ul></li><li><p><span>runtime analysis</span></p><ul><li><span>plotting of </span><em><span>tmp/id.#/RUN_CONTROL</span></em><span> data (available soon)</span></li></ul></li><li><p><span>postprocessing of output data</span></p><ul><li><span>regridding (available soon)</span></li></ul></li></ul><p>&nbsp;</p><p><span>...with a clear focus on the first, as it is clearly the most labor-intensive and tedious step of them all. Part of the Framework are also supporting files, such as conda environment setup files and bash routines, that support PALM simulation activities in general.</span></p><p><span>This Framework is the result of student work at the Center for Aviation, ZHAW School of Engineering in Winterthur and is work in progress.</span></p><p><span>DISCLAIMER: No liability is assumed regarding the correctness of the provided routines. Users shall check the behavior and the produced results carefull. Reporting of bugs is highly appreciated.</span></p><p>&nbsp;</p><h2><a name="applied-paradigms---how-it-works" class="md-header-anchor"></a><span>Applied Paradigms - how it works</span></h2><p><span>Framework Components</span></p><ul><li><span>palmpy Python Package</span></li><li><span>supporting Bash Scripts</span></li><li></li></ul><p>&nbsp;</p><p>&nbsp;</p><p><span>collection of functions</span></p><p><span>make static script to make static file</span></p><p><span>manual control with python programming language.</span></p><p>&nbsp;</p><p>&nbsp;</p><hr /><div style="page-break-after: always; break-after: page;"></div><div style="page-break-after: always; break-after: page;"></div><h1><a name="palmpy-description" class="md-header-anchor"></a><span>Palmpy Description</span></h1><p>&nbsp;</p><p>&nbsp;</p><h2><a name="geodatatools" class="md-header-anchor"></a><em><span>geodatatools</span></em></h2><p>&nbsp;</p><h2><a name="makestatictools" class="md-header-anchor"></a><em><span>makestatictools</span></em></h2><p>&nbsp;</p><h2><a name="mapdicts" class="md-header-anchor"></a><em><span>mapdicts</span></em></h2><p>&nbsp;</p><h2><a name="installation-of-palmpy" class="md-header-anchor"></a><span>Installation of palmpy</span></h2><h3><a name="python-environment" class="md-header-anchor"></a><span>Python Environment</span></h3><p><span>In order for palmpy to operate, you need the following packages:</span></p><p>&nbsp;</p><figure><table><thead><tr><th style='text-align:right;' ><span>Package Name</span></th><th style='text-align:center;' ><span>Version used in developing palmpy</span></th></tr></thead><tbody><tr><td style='text-align:right;' ><span>numpy</span></td><td style='text-align:center;' ><span>1.18.1</span></td></tr><tr><td style='text-align:right;' ><span>scipy</span></td><td style='text-align:center;' ><span>1.4.1</span></td></tr><tr><td style='text-align:right;' ><span>matplotlib</span></td><td style='text-align:center;' ><span>3.1.3</span></td></tr><tr><td style='text-align:right;' ><span>pillow</span></td><td style='text-align:center;' ><span>7.0.0</span></td></tr><tr><td style='text-align:right;' ><span>netcdf4</span></td><td style='text-align:center;' ><span>1.4.2</span></td></tr><tr><td style='text-align:right;' ><span>gdal</span></td><td style='text-align:center;' ><span>3.0.2</span></td></tr><tr><td style='text-align:right;' ><span>pynco</span></td><td style='text-align:center;' ><span>1.0.0</span></td></tr><tr><td style='text-align:right;' ><span>rasterio</span></td><td style='text-align:center;' ><span>1.1.0</span></td></tr><tr><td style='text-align:right;' ><span>(pandas)</span></td><td style='text-align:center;' ><span>1.0.3</span></td></tr><tr><td style='text-align:right;' ><span>(geopandas)</span></td><td style='text-align:center;' ><span>0.6.1</span></td></tr></tbody></table></figure><p>&nbsp;</p><p><span>It is strongly recommended to set up python with the conda package management ecosystem. There are many ways to do it. Users relatively unfamiliar with python can install the full </span><a href='https://www.anaconda.com/'><span>Anaconda</span></a><span> software, which comes with the most relevant python packages for doing science, but also with some baggage in form of software. More experienced users, who know what packages they need and are able to install them easily, can install python with a </span><a href='https://docs.conda.io/en/latest/miniconda.html'><span>Miniconda</span></a><span> installer, which only installs the bare minimum of packages and python on the machine (much smaller download size). Most importantly, the conda package manager is installed as well. </span></p><p><span>Once a running conda environment (usually named </span><code>base</code><span>, you can check it with entering </span><code>conda env list</code><span> into the Anaconda Prompt (in Windows) or your regular shell (in Linux)) is present. we set up a new environment that contains all necessary packages to run palmpy. Environment are an essential tool when it comes to software development and allows to &quot;freeze&quot; an environment to have defined package versions and dependencies for a particular project. After the following process, an environment &quot;palm&quot; (or however you name it) shall be present in the conda environment list.</span></p><p>&nbsp;</p><p><img src="palmpy-documentation.assets\image-20200415113429165.png" alt="image-20200415113429165" style="zoom:80%;" /></p><center><font size="-1">Different conda environments on a computer.</font></center><p>&nbsp;</p><p><span>Depending on your system, choose the appropriate .yml file from the </span><code>env</code><span> folder. Try to use the one with package version info first. This may not work on systems other than Windows 10 x86.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  conda env create <span class="cm-attribute">-f</span> palmenv-versinfo.yml <span class="cm-attribute">-n</span> &lt;envname&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>The string after </span><code>-f</code><span> represents the path to the .yml file, the string after </span><code>-n</code><span> the name of the environment that you create. If it does not work because some packages are not found, use the .yml file without version numbers attached to the packages. If there are errors relating to &quot;invalid name&quot; or similar, check your path to the .yml file.</span></p><p>&nbsp;</p><h4><a name="a-word-on-environments-and-packages" class="md-header-anchor"></a><span>A Word on Environments and Packages</span></h4><p><span>This concept of having various environments with the same packages over and over again may be confusing to new python users at first. However, it makes perfect sense to have controlled package versions for a project. As python modules are updated, some functions may stop working, and new functions may be added that make life much easier. Having a python environment for everyone working on a project ensures that everyone is able to execute this particular code and it can be shared among coworkers. Therefore, and because palmpy is the result of a student project, continuous maintenance will not be available. Should therefore e.g. numpy be updated and a specific function be made obsolete, on which palmpy relied on heavily, the code will simply stop working. Therefore, installing a python environment from a yml file ensures that the environment is set up correctly with correct version numbers. However, this process can be prone to errors, especially when installing an environment on different operating systems. Therefore, a .yml file without version names is included, that should work on any given operating system. </span></p><p><span>For this project, Spyder was used to write palmpy. Spyder is a package like any other and can be installed with conda. When installing multiple environments and you intend to use spyder for every one of them, it seems that you have to include the spyder package in these environments as well. In the end, when you start up spyder to work on a particular project, make sure to open the correct one - you can recognize that on the Shortcut name &quot;Spyder (palm)&quot; or &quot;Spyder&quot; (no env name for the base environment) or &quot;Spyder (randomproject)&quot;.</span></p><p>&nbsp;</p><h3><a name="package-installation" class="md-header-anchor"></a><span>Package Installation</span></h3><p><span>When importing a package in python with </span><code>import package</code><span>, python automatically scans its $PATH variable for the required package. Therefore, if we want palmpy to be fount, we need to move the palmpy folder into one of those locations. In order to know, where you should put it, open a python console in your newly created environment (eg. open </span><code>Spyder (envname)</code><span> to open Spyder with your desired environment or open Anaconda promt, run </span><code>conda activate envname</code><span>, followed by </span><code>python</code><span> to enter the python interpreter).  Run the following:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">sys</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">sys</span>.<span class="cm-property">path</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>This will output a list of paths, that are searched for the module. Your best bet is to put the palmpy module folder into your </span><code>...\\Miniconda3\\envs\envname\\lib</code><span> folder.</span></p><p><span>If you are able to import the module palmpy with </span><code>import palmpy</code><span> and no error appears, the package was installed correctly.</span></p><p>&nbsp;</p><p>&nbsp;</p><h3><a name="basic-usage" class="md-header-anchor"></a><span>Basic Usage</span></h3><p><span>It is recommended to load the different modules of the palmpy package as follows:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#static file generation</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">palmpy</span>.<span class="cm-property">staticcreation</span>.<span class="cm-property">geodatatools</span> <span class="cm-keyword">as</span> <span class="cm-variable">gdt</span> &nbsp; &nbsp; &nbsp;<span class="cm-comment"># geodata modification tools</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">palmpy</span>.<span class="cm-property">staticcreation</span>.<span class="cm-property">makestatictools</span> <span class="cm-keyword">as</span> <span class="cm-variable">mst</span> &nbsp; <span class="cm-comment"># static generation tools</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">palmpy</span>.<span class="cm-property">staticcreation</span>.<span class="cm-property">mapdicts</span> <span class="cm-keyword">as</span> <span class="cm-variable">mpd</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span> &nbsp;<span class="cm-comment"># mapping dictionaries for mst</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#post processing</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">palmpy</span>.<span class="cm-property">postprocessing</span>.<span class="cm-property">tools</span> <span class="cm-keyword">as</span> <span class="cm-variable">ppt</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-comment"># postprocessing tools</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><p>&nbsp;</p><p><span>To create a static file, you need the palmpy </span><em><span>geodatatools</span></em><span>, </span><em><span>makestatictools</span></em><span> and the dictionaries for mapping shp-file classes to PALM classes - which are separately available in </span><em><span>mapdicts</span></em><span>. Should a default mapping be not suitable for a particular project, this </span><em><span>mapdict</span></em><span>s file can be modified accordingly. For individual application of palmpy, these dicts can be accessed through python individually.</span></p><p>&nbsp;</p><p>&nbsp;</p><hr /><div style="page-break-after: always; break-after: page;"></div><h1><a name="create-a-palm-static-driver-using-palmpy" class="md-header-anchor"></a><span>Create a PALM Static driver using palmpy</span></h1><h3><a name="qgis-input-file-preparation" class="md-header-anchor"></a><span>QGIS Input File Preparation</span></h3><p>&nbsp;</p><h4><a name="paradigms-and-standards" class="md-header-anchor"></a><span>Paradigms and Standards</span></h4><p>&nbsp;</p><p>&nbsp;</p><h4><a name="rastered-data" class="md-header-anchor"></a><span>Rastered Data</span></h4><p><span>geotiff</span></p><h5><a name="topography" class="md-header-anchor"></a><span>Topography</span></h5><p>&nbsp;</p><h5><a name="surface-classification" class="md-header-anchor"></a><span>Surface Classification</span></h5><p>&nbsp;</p><p>&nbsp;</p><h4><a name="shapefiles" class="md-header-anchor"></a><span>Shapefiles</span></h4><p><span>insert Table here</span></p><p>&nbsp;</p><h5><a name="resolved-vegetation" class="md-header-anchor"></a><span>Resolved Vegetation</span></h5><p>&nbsp;</p><h5><a name="pavement--sealed-surfaces" class="md-header-anchor"></a><span>Pavement / Sealed Surfaces</span></h5><p>&nbsp;</p><h5><a name="crops" class="md-header-anchor"></a><span>Crops</span></h5><figure><table><thead><tr><th><span>OBJEKTART</span></th><th><span>Crop Type</span></th></tr></thead><tbody><tr><td><span>1000</span></td><td><span>Bare Field</span></td></tr><tr><td><span>1001</span></td><td><span>Grass Field</span></td></tr><tr><td><span>1002</span></td><td><span>Low Crops (Such as beet, Potatoes, )</span></td></tr><tr><td><span>1003</span></td><td><span>Wheat</span></td></tr><tr><td><span>1004</span></td><td><span>Corn</span></td></tr></tbody></table></figure><p>&nbsp;</p><p>&nbsp;</p><h5><a name="buildings" class="md-header-anchor"></a><span>Buildings</span></h5><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h3><a name="static-file-generation-script" class="md-header-anchor"></a><span>Static File Generation Script</span></h3><p>&nbsp;</p><h4><a name="script" class="md-header-anchor"></a><span>Script</span></h4><p><span>How the Script works</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h4><a name="namelist" class="md-header-anchor"></a><span>Namelist</span></h4><p><span>The namelist is used to provide all necessary information to create the static driver file. The namelist is split into different sections, which provide some kind of organization to the namelist file. The namlist is a file that ends in </span><code>.ini</code><span>, a common ending for configuration files in Windows and other applications. Below, each section and its parameters are described. </span></p><p><em><span>Note: </span><strong><span>All parameters need to be provided</span></strong><span> in a config file. However, if some parameter is not needed, the part after the equal sign can be left blank. Furthermore, all values are interpreted by the script as strings. So if a string is to be provided, no &quot;&quot; need to be set. If an int or float are required, just provide the number (i.e. 1 or 1.0).</span></em></p><p>&nbsp;</p><p><code>[settings]</code></p><p><span>This section contains top level information about the simulation.</span></p><figure><table><thead><tr><th><span>Parameter</span></th><th><span>dtype</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><em><span>casename</span></em></td><td><span>string</span></td><td><span>Name of the case. Used to construct the file names for the script output.</span></td></tr><tr><td><em><span>origin_time</span></em></td><td><span>YYYY-MM-DD HH:mm:SS +TZ</span></td><td><span>Origin time of the PALM simulation. This is a critical parameter and needs to be set correctly, otherwise the sun position and COSMO forcing may be incorrect.</span></td></tr><tr><td><em><span>totaldomains</span></em></td><td><span>int</span></td><td><span>Number of Domains that are to be set.</span></td></tr><tr><td><em><span>cutorthoimg</span></em></td><td><span>boolean</span></td><td><code>True</code><span> if for each domain an orthoimage shall be cut to the correct extents. Can be used in VAPOR visualizations. </span><code>False</code><span> if not needed.</span></td></tr><tr><td><em><span>extentsonly</span></em></td><td><span>boolean</span></td><td><span>If </span><code>True</code><span>, only the config file is read, checks are done and the extents are plotted in a graph. This can be used to fine-tune the choice of extents and probe locations.</span></td></tr><tr><td><em><span>mapdialect</span></em></td><td><span>string</span></td><td><span>Keyword, which mapping dictionaries shall be used. Available options are </span><code>tlm</code><span>, </span><code>custom</code><span>. This will decide which python file with which dictionaries is loaded as </span><code>mpd.*</code><span> module.</span></td></tr><tr><td><em><span>orthores</span></em></td><td><span>int</span></td><td><span>Resolution of the image on which the extents are to be plotted. For larger domains this resultion can be increased (5m or higher), for small ones choose a smaller resolution (2 m). Lower resultions result in larger file sizes.</span></td></tr><tr><td><em><span>rotationangle</span></em></td><td><span>float</span></td><td><span>Angle by which the domain is rotated. Useful in runs with noncyclic BC as specific wind-tunnel like setups. Not really supported at the moment by PALM.</span></td></tr><tr><td><em><span>set_vmag</span></em></td><td><span>float</span></td><td><span>Estimated velocities that are set by you or INIFOR. Used to calculate a runtime score, that gives a hint about the cases complexity and therefore its runtime.</span></td></tr><tr><td><em><span>simtime</span></em></td><td><span>float</span></td><td><span>Used to construct the inifor namelist, that is also output when running the make_static.py script.</span></td></tr></tbody></table></figure><p>&nbsp;</p><p><code>[paths]</code></p><p><span>In this section all paths need to be specified to the required files. The path separator that is used here is </span><code>\</code><span> in windows and </span><code>/</code><span> for linux paths. Preferrably use absolute paths.</span></p><figure><table><thead><tr><th><span>Parameter</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><em><span>modulepath</span></em></td><td><span>Path to the palmpy folder. Needs a trailing separator.</span><br><span>Example: </span><code>modulepath = C:\Users\Username\Documents</code></td></tr><tr><td><em><span>inputfilepath</span></em></td><td><span>Path where all the input files are stored. Needs a trailing separator.</span></td></tr><tr><td><em><span>outpath</span></em></td><td><span>Path where the output files shall be saved. Needs a trailing separator.</span><br><span>Example: </span><code>tmp = C:\Users\Username\Desktop\case\</code></td></tr><tr><td><em><span>tmp</span></em></td><td><span>Path where temporary raster files shall be saved (usually to a tmp folder within the outpath). Needs a trailing separator.</span><br><span>Example: </span><code>tmp = C:\Users\Username\Desktop\case\tmp\</code></td></tr><tr><td><em><span>orthoimage</span></em></td><td><span>Filename of the Orthoimage. Needed if </span><code>cutorthoimg</code><span> is set to true and extents shall be plotted.</span></td></tr><tr><td><em><span>dhm</span></em></td><td><span>Filename of the digital height model (without buildings) raster file (geotiff). Used to create the terrain for the PALM simulation.</span></td></tr><tr><td><em><span>bb</span></em></td><td><span>Filename of the shapefile with land cover information. This information will be resolved in parametrized in 2D. Used to construct the </span><code>vegetation_type</code><span> variable.</span></td></tr><tr><td><em><span>resolvedforest</span></em></td><td><span>Filename of the shapefile with forest polygons that shall be resolved in 3D (e.g. extract from land cover file). If 3D vegetation shall be resolved, one of </span><code>resolvedforest, treerows</code><span> or </span><code>singletrees</code><span> shall be provided. Used to construct the </span><code>LAD</code><span> variable.</span></td></tr><tr><td><em><span>treerows</span></em></td><td><span>Filename of the shapefile with tree line polygons that shall be resolved in 3D (e.g. puffered from shapefile with line features). If 3D vegetation shall be resolved, one of </span><code>resolvedforest, treerows</code><span> or </span><code>singletrees</code><span> shall be provided. Used to construct the </span><code>LAD</code><span> variable.</span></td></tr><tr><td><em><span>singletrees</span></em></td><td><span>Filename of the shapefile with single tree polygons that shall be resolved in 3D (e.g. puffered from shapefile with point features). If 3D vegetation shall be resolved, one of </span><code>resolvedforest, treerows</code><span> or </span><code>singletrees</code><span> shall be provided. Used to construct the </span><code>LAD</code><span> variable.</span></td></tr><tr><td><em><span>pavementareas</span></em></td><td><span>Filename of the shapefile with information about paved areas, such as streets, parking lots, town squares, everything that is not vegetation and is an artificially sealed surface (e.g. merged shapefiles with street, railways, airport movement areas, parking lots etc.). Will be used for </span><code>pavement_type</code><span> variable.</span></td></tr><tr><td><em><span>gebaeudefoots</span></em></td><td><span>Filename of the shapefile with information about building footprints. Used to create buildings in 2D and 3D (to benefit from the latter, </span><code>HEIGHT_BOT</code><span> needs to be provided as an attribute).</span></td></tr><tr><td><em><span>crops</span></em></td><td><span>Filename of the shapefile with information about crop fields. Crop field information may not be present in land cover data as it changes often.</span></td></tr><tr><td><em><span>streetsonly</span></em></td><td><span>Filename of a shapefile with street information only (needs to be provided for creating the </span><code>street_type</code><span> variable for emission representation).</span></td></tr></tbody></table></figure><p>&nbsp;</p><p><code>[probes]</code></p><p><span>It is possible to specify probe locations in the namelist. The script will plot their positions on the overview plot and plot probe coordinates respective to each chosen domain.</span></p><figure><table><thead><tr><th><span>Variable</span></th><th><span>dtype</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><span>probes_E</span></td><td><span>float, float, ...</span></td><td><span>List of Easting Coordinates of a probe, separated by a comma. The first entry corresponds the first probe, and so forth.</span></td></tr><tr><td><span>probes_N</span></td><td><span>float, float ...</span></td><td><span>List of Northing Coordinates of a probe, separated by a comma. The first entry corresponds the first probe, and so forth.</span></td></tr></tbody></table></figure><p>&nbsp;</p><p><code>[change_npars]</code></p><p><span>In order to change vegetation, pavement, water, soil or albedo parameters individually, set the flags </span><code>dovegpars</code><span> or </span><code>doalbpars</code><span> to </span><code>True</code><span> for each domain. If a flag is set to </span><code>True</code><span>, values must be provided or an error is raised (</span><code>string index out of range</code><span>). In the following,  </span><code>filterarr</code><span> refers to an array which is searched for the </span><code>filtervalue</code><span> - where the search matches, the </span><code>newvalue</code><span> is put into the </span><code>x_pars</code><span> array on the </span><code>npar</code><span>&#39;th level (see PALM documentation, PIDS Tables). The four values to be provided can be remembered as: &quot;Set the parameter </span><code>npar</code><span> to </span><code>newvalue</code><span> where the pixel in </span><code>filterarr</code><span> equals </span><code>filtervalue</code><span>&quot;.</span></p><figure><table><thead><tr><th><span>Parameter</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><em><span>vegparchanges</span></em></td><td><span>Provide in form </span><code>npar:newvalue:filterarr:filtervalue</code><span>, where filterarr  = 0 means from source array, filterarr = 1 corresponds to array after mapping (palm classes). For crop types (&gt;= 1000) only 0 is supported. Multiple requested changes are to be separated by commas. </span><br><br><span>Example: </span><code>vegparchanges = 4:0.5:0:1004, 4:0.2:0:1003</code></td></tr><tr><td><em><span>watparchanges</span></em></td><td><span>Provide in form </span><code>npar:newvalue:filterarr:filtervalue</code><span>, where filterarr  = 0 means from source array, filterarr = 1 corresponds to array after mapping (palm classes). Multiple requested changes are to be separated by commas.</span></td></tr><tr><td><em><span>pavparchanges</span></em></td><td><span>Provide in form </span><code>npar:newvalue:filterarr:filtervalue</code><span>, where filterarr  = 0 means from source array, filterarr = 1 corresponds to array after mapping (palm classes). Multiple requested changes are to be separated by commas.</span></td></tr><tr><td><em><span>soilparchanges</span></em></td><td><span>Provide in form </span><code>npar:newvalue:filterarr:filtervalue</code><span>, where filterarr  = 0 means from source array, filterarr = 1 corresponds to array after mapping (palm classes). Multiple requested changes are to be separated by commas.</span></td></tr><tr><td><em><span>albedoparchanges</span></em></td><td><span>Provide in form </span><code>npar:newvalue:filterarr:filtervalue</code><span>, where filterarr  = 0 means from source array, filterarr = 1 corresponds to array after mapping (palm classes). Multiple requested changes are to be separated by commas.</span></td></tr><tr><td><em><span>bldgparchanges</span></em></td><td><span>Provide in form </span><code>npar:newvalue:filterarr:filtervalue</code><span>. Filterarr here corresponds to the following attributes: </span><br><span>- 0: </span><code>building_type</code><br><span>- 1, 2, 3 : </span><code>GROUPING1</code><span>, </span><code>GROUPING2</code><span>, </span><code>GROUPING3</code><br><span>... of the building footprints shapefile. This way, either all elements of a certain building type can be changed, or logical groupings can be defined on three levels (e.g. by zip code, by color, by group to be changed or whatever). More levels can be added easily to the script.</span></td></tr></tbody></table></figure><p>&nbsp;</p><p><code>[domain_N]</code></p><p><span>For each domain, the following parameters shall be given. </span></p><figure><table><thead><tr><th><span>Parameter</span></th><th><span>dtype</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><em><span>ischild</span></em></td><td><span>int</span></td><td><span>Domain Number. Parent is 0, every child domain has a value above 0.</span></td></tr><tr><td><em><span>xlen</span></em></td><td><span>int</span></td><td><span>X extent of the domain (eastwards) in meter.</span></td></tr><tr><td><em><span>ylen</span></em></td><td><span>int</span></td><td><span>Y extent of the domain (northwards) in meter.</span></td></tr><tr><td><em><span>xmin</span></em></td><td><span>float</span></td><td><span>X (Easting) coordinate position of the lower left domain corner.</span></td></tr><tr><td><em><span>ymin</span></em></td><td><span>float</span></td><td><span>Y (Northing) coordinate position of the lower left domain corner.</span></td></tr><tr><td><em><span>zmax</span></em></td><td><span>float</span></td><td><span>Domain vertical extent in meters.</span></td></tr><tr><td><em><span>xres</span></em></td><td><span>float</span></td><td><span>Domain resolution in X direction.</span></td></tr><tr><td><em><span>yres</span></em></td><td><span>float</span></td><td><span>Domain resolution in Y direction.</span></td></tr><tr><td><em><span>zres</span></em></td><td><span>float</span></td><td><span>Domain resolution in Z direction.</span></td></tr><tr><td><em><span>doterrain</span></em></td><td><span>boolean</span></td><td><span>D</span></td></tr><tr><td><em><span>dotlmbb</span></em></td><td><span>boolean</span></td><td><span>Create vegetation_type variable for this domain.</span></td></tr><tr><td><em><span>dopavedbb</span></em></td><td><span>boolean</span></td><td><span>Create pavement_type variable for this domain.</span></td></tr><tr><td><em><span>docropfields</span></em></td><td><span>boolean</span></td><td><span>Incorporate additional crop field information (set vegetation_type = 2) based on an additional shapefile.</span></td></tr><tr><td><em><span>dolad</span></em></td><td><span>boolean</span></td><td><span>Create 3D resolved vegetation for this domain.</span></td></tr><tr><td><em><span>dobuildings2d</span></em></td><td><span>boolean</span></td><td><span>Create 2D buildings with height information for this domain.</span></td></tr><tr><td><em><span>dobuildings3d</span></em></td><td><span>boolean</span></td><td><span>Create 3D buildings (each grid point = 1 or 0) for this domain.</span></td></tr><tr><td><em><span>dovegpars</span></em></td><td><span>boolean</span></td><td><span>Change individual vegetation parameters based on provided </span><code>vegparchanges</code><span> information for this domain. It is good practice to set this parameter the same for all domains.</span></td></tr><tr><td><em><span>doalbedopars</span></em></td><td><span>boolean</span></td><td><span>Change individual albedo parameters based on provided </span><code>albedoparchanges</code><span> information for this domain. It is good practice to set this parameter the same for all domains.</span></td></tr><tr><td><em><span>dostreettypes</span></em></td><td><span>boolean</span></td><td><span>Create a </span><code>street_type</code><span> variable for this domain.</span></td></tr><tr><td><em><span>bulkvegclass</span></em></td><td><span>boolean</span></td><td><span>Assign this value / PALM vegetation class to pixels in </span><code>vegetation_type</code><span> that have not been covered by the input shapefiles. Usually 3 for grass or 1 for bare soil.</span></td></tr><tr><td><em><span>pave_alltouched</span></em></td><td><span>boolean</span></td><td><span>Method selector during shapefile polygon rasterization with GDAL. Activates the GDAL option &quot;ALL_TOUCHED&quot; . This means that the shapefile value is burnt into every pixel the polygon touches, instead of burning in the value only if the centroid of the pixel is within the polygon.   If the domain resolution is chosen too coarse, streets may not be rasterized continuously anymore and potential emission locations become unrealistic. With </span><code>pave_alltouched = True</code><span>, streets may become too wide, however they are still continuous.</span></td></tr><tr><td><em><span>bulkpavclass</span></em></td><td><span>boolean</span></td><td><span>Assign this value / PALM pavement class to pixels in </span><code>pavement_type</code><span> that have not been covered by the input shapefiles. Usually 1 for asphalt/concrete mix.</span></td></tr><tr><td><em><span>lai_forest</span></em></td><td><span>float</span></td><td><span>Leaf Area Index for forest polygons. Parameter to construct a Leaf Area Density vertical profile.</span></td></tr><tr><td><em><span>lai_breihe</span></em></td><td><span>float</span></td><td><span>Leaf Area Index for tree line polygons. Parameter to construct a Leaf Area Density vertical profile.</span></td></tr><tr><td><em><span>lai_ebgebu</span></em></td><td><span>float</span></td><td><span>Leaf Area Index for single tree polygons. Parameter to construct a Leaf Area Density vertical profile.</span></td></tr><tr><td><em><span>a_forest</span></em></td><td><span>float</span></td><td><span>alpha Shape parameter for beta-distribution for forest polygons. Parameter to construct a Leaf Area Density vertical profile.</span></td></tr><tr><td><em><span>b_forest</span></em></td><td><span>float</span></td><td><span>beta shape parameter for beta-distribution for forest polygons. Parameter to construct a Leaf Area Density vertical profile.</span></td></tr><tr><td><em><span>a_breihe</span></em></td><td><span>float</span></td><td><span>alpha shape parameter for beta-distribution for tree line polygons. Parameter to construct a Leaf Area Density vertical profile.</span></td></tr><tr><td><em><span>b_breihe</span></em></td><td><span>float</span></td><td><span>beta shape parameter for beta-distribution for tree line polygons. Parameter to construct a Leaf Area Density vertical profile.</span></td></tr><tr><td><em><span>a_ebgebu</span></em></td><td><span>float</span></td><td><span>alpha shape parameter for beta-distribution for single tree polygons. Parameter to construct a Leaf Area Density vertical profile.</span></td></tr><tr><td><em><span>b_ebgebu</span></em></td><td><span>float</span></td><td><span>beta shape parameter for beta-distribution for single tree polygons. Parameter to construct a Leaf Area Density vertical profile.</span></td></tr></tbody></table></figure><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h4><a name="hints-regarding-domain-creation" class="md-header-anchor"></a><span>Hints Regarding Domain Creation</span></h4><h5><a name="grid-dimensions" class="md-header-anchor"></a><span>Grid Dimensions</span></h5><p><span>Choosing valid domain extents can be tricky. There are a few rules that need to be followed, which are explained next. </span></p><p><strong><span>Limitations  on nx and ny</span></strong></p><p><span>When choosing the extents of the domains, keep in mind that the resulting number of gridpoints in x and y direction (</span><code>nx</code><span> and </span><code>ny</code><span>) must match the processor grid that results due to your choice of number of cores. What does that mean? When assigning 24 processor entities (cores, PE) to a domain, the domain will be split into 24 subdomains, one for each processor. With 24 cores, the resulting processor grid will be a 6 by 4 grid (whose dimensions are called </span><code>npex</code><span> and </span><code>npey</code><span>). Therefore, your </span><code>nx</code><span> and </span><code>ny</code><span> respectively must be integer divisible by  </span><code>npex</code><span> and </span><code>npey</code><span>.  Furthermore, which is a bit more tricky is the fact that </span><code>(nxy+1)/npexy</code><span> must hold with the result containing a factor 2</span><sup><span>n </span></sup><span> with n &gt;= 2. Choose basic domain extents, check the distribution of cells with the chosen resolution. Optimize the core count per domain based on their factorization (</span><code>npex and npey</code><span>).  </span></p><p>&nbsp;</p><p><img src="palmpy-documentation.assets/image-20200423170812814.png" referrerpolicy="no-referrer" alt="image-20200423170812814"></p><center><font size="-1">With wrong nx and ny values, the multigrid solver cannot work correctly and may become unstable.</font></center><p>&nbsp;</p><p><span>There is a python script </span><code>palm_gf</code><span> that should simplify the grid finding process. What will mostly work best is a processor grid that has 2</span><sup><span>n</span></sup><span> values in x and y direction (32 cores = 4x8, 64 cores = 8x8, 16 cores = 4x4, 8 cores = 2x4, ...). So use nx and ny that are powers of two and also core numbers that are powers of two. </span></p><p><span>To get maximum usage out of speedflyer, use for example the following number of cores (not exhaustive):</span></p><figure><table><thead><tr><th style='text-align:center;' ><span># Domains</span></th><th style='text-align:center;' ><span>Domain 1</span></th><th style='text-align:center;' ><span>Domain 2</span></th><th style='text-align:center;' ><span>Domain 3</span></th><th style='text-align:center;' ><span>Domain 4</span></th><th style='text-align:center;' ><span>Domain 5</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>1</span></td><td style='text-align:center;' ><span>64</span></td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td></tr><tr><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>64</span></td><td style='text-align:center;' ><span>32</span></td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td></tr><tr><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>32</span></td><td style='text-align:center;' ><span>32</span></td><td style='text-align:center;' ><span>32</span></td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td></tr><tr><td style='text-align:center;' ><span>4</span></td><td style='text-align:center;' ><span>32</span></td><td style='text-align:center;' ><span>32</span></td><td style='text-align:center;' ><span>16</span></td><td style='text-align:center;' ><span>16</span></td><td style='text-align:center;' >&nbsp;</td></tr><tr><td style='text-align:center;' ><span>5</span></td><td style='text-align:center;' ><span>32</span></td><td style='text-align:center;' ><span>32</span></td><td style='text-align:center;' ><span>16</span></td><td style='text-align:center;' ><span>8</span></td><td style='text-align:center;' ><span>8</span></td></tr></tbody></table></figure><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr /><div style="page-break-after: always; break-after: page;"></div><h1><a name="further-information" class="md-header-anchor"></a><span>Further Information</span></h1><h2><a name="dynamic-driver-generation-with-inifor" class="md-header-anchor"></a><span>Dynamic Driver Generation with INIFOR</span></h2><p><span>PALM can be forced with COSMO-Data. PALM is shipped with a routine called INIFOR, which interpolates boundary conditions from hourly COSMO-DE data for the lateral and top boundary, furthermore, it creates an initial condition volume field for the domain. Also, geostrophic wind components are extracted from the COSMO pressure field, as well as a surface pressure value. </span></p><p><span>With its orientation towards data available in Germany, INIFOR is intended to be used with COSMO-DE data, which is available in 2 km resolution and with a specific naming of the variables. Swiss COSMO-Data, which was made available so far with the ZHAW, is in a different format and in 1 km resolution. Apart from this, the variable naming does not seem to be consistent anyway, which requires some modifications to the COSMO-Files before being able to use them in INIFOR. To convert them into INIFOR-readable format, two scripts for two different conventions have been written (routines cosmo2inifor). Their operation is detailed below. After conversion, INIFOR can be run, this process is also outlined below.</span></p><p>&nbsp;</p><h3><a name="cosmo2inifor" class="md-header-anchor"></a><span>cosmo2inifor</span></h3><p><span>cosmo2inifor is a bash script, that converts COSMO-1 Data to INIFOR-appropriate format. Two revisions exist, which support two different variable conventions:</span></p><figure><table><thead><tr><th><span>Name</span></th><th><span>Use with</span></th></tr></thead><tbody><tr><td><span>cosmo2inifor_revC</span></td><td><span>lafYYYYMMDDHH.nc files from ETH Server</span></td></tr><tr><td><span>cosmo2inifor_revD</span></td><td><span>meteotest_....nc file (multiple files per hour), received for project at the ZHAW</span></td></tr></tbody></table></figure><p><span>Should you encounter a COSMO-Output format that cannot be processed with one of the above routines, a specifically tailored one needs to be set up or can be derived from the above routines.</span></p><p><span>These routines make use of </span></p><ul><li><span>nco (4.8.1): ncks, ncrename, ncatted, ncap2</span></li><li><span>netcdf (4.6.1): ncdump</span></li></ul><p>&nbsp;</p><p><strong><span>Using cosmo2inifor</span></strong></p><ol start='' ><li><span>On the ZAV cluster (Twins), these modules can be loaded with the command </span><code>module load nco/4.8.1 netcdf/4.6.1-gnu</code><span>. </span></li><li><span>Put the files, that are to be converted, into a directory with the cosmo2inifor routine. If you simulate a time span of 1200Z-1600Z, you need the files with results of the hours 12, 13, 14, 15 </span><em><span>and</span></em><span> 16.</span></li><li><span>Run the script with </span><code>./cosmo2inifor_revX</code><span>. It will extract a </span><code>hhl.nc</code><span>, </span><code>soil.nc</code><span> and for each hour a </span><code>segYYYYMMDDHH-flow.nc</code><span> and </span><code>segYYYYMMDDHH-soil.nc</code><span> file.</span></li></ol><p>&nbsp;</p><p><em><span>Special Case _revD</span></em><span>: As this routine is designed to work with a specific meteotest format that the ZHAW received on a one-time-only basis, there are some more restrictions on its use. For instance, HHL and Soiltype information is available in a separate file instead of it being included in 00Z files. Put the Files containing HHL and soiltype (</span><code>meteotest_..._hhl/soiltyp_...00.nc</code><span>) into a subdirectory called </span><code>hhlsoil</code><span>. The filenames are hardcoded at the moment, so change them in the cosmo2inifor_revC file (</span><code>hhlfile</code><span> and </span><code>soilfile</code><span>).</span></p><p>&nbsp;</p><h3><a name="inifor" class="md-header-anchor"></a><span>INIFOR</span></h3><p><span>INIFOR will interpolate (bilinear, as of April 2020) boundary conditions from the COSMO data. It requires a soil.nc, hhl.nc and for each hour a -flow.nc and a -soil.nc file, which need to be available in a single location. It also requires a namelist containing information of the parent domain (the one that will be forced). It can look like the following:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="fortran"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="fortran"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&amp;</span><span class="cm-variable">inipar</span> <span class="cm-variable">nx</span> <span class="cm-operator">=</span> <span class="cm-number">127</span>, <span class="cm-variable">ny</span> <span class="cm-operator">=</span> <span class="cm-number">127</span>, <span class="cm-variable">nz</span> <span class="cm-operator">=</span> <span class="cm-number">96</span>,</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">dx</span> <span class="cm-operator">=</span> <span class="cm-number">32.0</span>, <span class="cm-variable">dy</span> <span class="cm-operator">=</span> <span class="cm-number">32.0</span>, <span class="cm-variable">dz</span> <span class="cm-operator">=</span> <span class="cm-number">32.0</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-operator">/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&amp;</span><span class="cm-variable">d3par</span> &nbsp; &nbsp;<span class="cm-variable">end_time</span> <span class="cm-operator">=</span> <span class="cm-number">86400.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-operator">/</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><p><span>Under </span><code>&amp;inipar</code><span>, grid information of the parent is given. Under </span><code>&amp;d3par</code><span> the endtime is given. This namelist file is automatically generated when running make_static.py, taking all necessary information from the corresponding namelist for the make_static routine. Coordinates are taken from the static-driver, so it has to be ensured that this information is correct. Furthermore, even though the static-file origin_time attribute is unused for now, it will be used in the future, so it should be correctly set as well. It has the format </span><code>YYYY-MM-DD HH:MM:SS +ZZ</code><span>. </span></p><p><span>Load required modules to run PALM before running INIFOR. INIFOR is executed as follows in the bash shell:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">inifor <span class="cm-attribute">-p</span> &lt;path&gt; <span class="cm-attribute">-d</span> &lt;YYYYMMDDHH (in UTC)&gt; <span class="cm-attribute">-i</span> &lt;init-mode&gt; <span class="cm-attribute">-n</span> &lt;namelist&gt; <span class="cm-attribute">--input-prefix</span> &lt;input-prefix&gt; <span class="cm-attribute">-t</span> &lt;static-driver&gt; <span class="cm-attribute">-o</span> &lt;output&gt; <span class="cm-attribute">-a</span> &lt;averaging-angle&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p>&nbsp;</p><p><strong><span>Hints / Troubleshooting:</span></strong></p><ul><li><span>Date format: YYYYMMDDHH. Start time stamp is used, it know how far to process from the end_time parameter in the namelist.</span></li><li><span>input-prefix is </span><code>seg</code><span>, if the files were processed with cosmo2inifor. Standard is </span><code>laf</code><span>.</span></li><li><span>Averaging angle </span><code>-a</code><span> might not work if the is below 0.2. So far, no real changes were visible when going from an averaging angle of 0.1 to 0.01.</span></li><li><span>If a segmentation-fault occurs during processing, create a copy of the .palm.config.twins18 and recompile it with </span><code>palmbuild -c twins18(copy)</code><span>. This seems to recompile INIFOR too. Usually it works again after that. Negative averaging angles also lead to a segmentation fault.</span></li></ul><p>&nbsp;</p><p>&nbsp;</p><h2><a name="vapor-visualization" class="md-header-anchor"></a><span>VAPOR Visualization</span></h2><p><span>VAPOR is a visualization tool for scientific 3D data. From VAPOR 3 and above, netCDF files can be imported easily, if they conform to the CF-1.7 standard. This requires to have an &quot;axis&quot;-attribute for each coordinate variable (e.g.</span><code>axis:X</code><span>for the </span><code>x</code><span> variable, and so forth for </span><code>xu, y, yv, zu_3d, zw_3d, zs_3d</code><span>). This was missing until recently in PALM, this axis is now automatically added (from March 2020 onwards). Before, it could be added with </span><code>ncatted -O -a axis,x,o,c,&quot;X&quot; &lt;file&gt;</code><span> for example.</span></p><p><span>In order to have terrain in the 3D, file this information needs to be copied from the static driver to the 3D-File. This can be achieved with the following command:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ncks -A -v &lt;static-file&gt; &lt;3d_output_file&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>Bear in mind, that this is currently only easily doable for netcdf-3 output on the PALM side (netcdf_output_format == 3). </span></p><p><span>VAPOR works on the basis of vdc files. NetCDF files can be converted into vdc files with a series of VAPOR command line tools - however, I have not managed to complete the whole process. It should be doable with the commands (in this order) </span><code>cfvdccreate &lt;outputfile&gt; &lt;file.vdc&gt;</code><span>, which creates a header file. Then, </span><code>cf2vdc outputfile file.vdc</code><span> should populate the file with data from the nc-file. </span></p><p>&nbsp;</p><h2><a name="palm-simulation-lessons-learned" class="md-header-anchor"></a><span>PALM Simulation Lessons Learned</span></h2><p><span>The following questions are written down here for a reason. They are important questions to ask yourself when simulating with PALM.</span></p><p>&nbsp;</p><ul><li><span>Are the static driver </span><strong><span>time stamps, end_times and skip_time_data_output</span></strong><span> parameters in the namelists correct?</span></li><li><span>Are you simulating the </span><strong><span>correct day</span></strong><span>?</span></li><li><span>Have you supplied </span><code>-a &quot;d3#/r restart&quot;</code><span> when you want to continue your run after? If not, its all lost.</span></li><li><span>Have you checked that </span><strong><span>output variables</span></strong><span> are really only </span><strong><span>supplied once</span></strong><span>, especially the _av ones? (These arrays are set up after skip_time_data_output, if you skip large parts of your simulations, an error is raised and the simulation is lost)</span></li><li><span>A simulation can be started with </span><code>palmrun ...... -v &gt; logfile &amp;</code><span>. With this, the output is piped into a logfile and with </span><code>&amp;</code><span> the command is executed in a subshell. This means, that one can log out of the cluster without the palmrun routine being aborted. However, this does not protect the task from all kinds of aborts sent its way. To be totally save, start a case with </span><code>nohup palmrun ...... -v &gt; logfile &amp;</code><span>. This really ensures that even an unexpected logout does not kill the process.</span></li><li><span>When monitoring the simulation progress over a VPN connection with </span><code>tail -f &lt;logfile&gt;</code><span>, it might occur that the simulation aborts with the message </span><code>-&gt; palmrun finished</code><span> if the VPN session is aborted due to the computer entering energy saver mode or something else. It has proven more robust by monitoring the percentage of the simulation progress with spot checks, and await the completion of the job by monitoring the Ganglia load monitor. This might be only applicable to cases started without </span><code>nohup</code><span> in the palmrun call, but it was not tested. </span></li></ul><p>&nbsp;</p><hr /><div style="page-break-after: always; break-after: page;"></div><h1><a name="useful-code-snippets" class="md-header-anchor"></a><span>Useful Code Snippets</span></h1><h2><a name="castor--pollux-cluster" class="md-header-anchor"></a><span>Castor / Pollux Cluster</span></h2><p><span>load required modules to run PALM (</span><strong><span>basic configuration</span></strong><span>, without parallel I/O, no RRTMG!)</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">module load gnu mpich2/3.3.1-gnu hdf5/1.8.15-gnu7 netcdf/4.6.1-gnu7 netcdf/4.4.4-gfort7</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>use RRTMG as well (if compiled): run the following command before starting a simulation:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">LD_LIBRARY_PATH</span><span class="cm-operator">=</span>/cluster/home/&lt;rrtmg_install_location&gt;/lib/rrtmg/shared/lib:<span class="cm-def">$LD_LIBRARY_PATH</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p>&nbsp;</p><p><span>To choose </span><strong><span>how many cores</span></strong><span> the run should use can be steered with the hostfile supplied in the </span><code>.palm.config.&lt;identifier&gt;</code><span> file under </span><code>%execute_command</code><span>. There, a path to a hostfile is given, where for every node it&#39;s IP address is given and how many cores are available. This hostfile must look like the following:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># The following node is a dual processor machine:</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">192</span>.168.111.250:50</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># The following node is a dual-processor machine:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">192</span>.168.111.251:50</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><p><span>The config does not have to be recompiled. The flag </span><code>-T</code><span> does not have an effect on the Speedflyer cluster.</span></p><p>&nbsp;</p><p>&nbsp;</p><h2><a name="nco" class="md-header-anchor"></a><span>NCO</span></h2><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># overwrite attribute grid_mapping in variable SOILTYP (if global, write global) by a c(haracter) entry</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ncatted <span class="cm-attribute">-O</span> <span class="cm-attribute">-a</span> grid_mapping,SOILTYP,o,c,<span class="cm-string">'rotated_pole'</span> soil.nc</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#cut a file according to those dimensions given</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ncea <span class="cm-attribute">-d</span> y_1,-0.5,0.5 <span class="cm-attribute">-d</span> x_1,-1.0,0.0 filein fileout</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># add a value to a variable. -O is overwrite, -s is for an arithmetic expression.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ncap2 <span class="cm-attribute">-O</span> <span class="cm-attribute">-s</span> <span class="cm-def">‘time</span><span class="cm-operator">=</span>time<span class="cm-operator">+</span><span class="cm-number">39600</span>’ &lt;in&gt; &lt;out&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># copy variables from one into another file</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ncks <span class="cm-attribute">-A</span> <span class="cm-attribute">-v</span> &lt;var&gt; &lt;static-file&gt; &lt;3d_output_file&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># add an attribute to a variable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ncatted <span class="cm-attribute">-O</span> <span class="cm-attribute">-a</span> &lt;attname&gt;,&lt;var&gt;,&lt;mode mostly o&gt;,&lt;dtype (c <span class="cm-keyword">for</span> char)&gt;,<span class="cm-string">"&lt;attribute&gt;"</span> &lt;file&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># concatenate output files to one large file (only works without errors if equal variables are present)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ncrcat <span class="cm-attribute">-v</span> var1,var2,var3 inputfiles outputfiles</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># as an example with multiple input files and all variables:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ncrcat yv-jor-2_av_3d_N02.00{0..5}.nc yv-jor-2_av_3d_N02.nc</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 483px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></pre><p>&nbsp;</p><h2><a name="cdo" class="md-header-anchor"></a><span>CDO</span></h2><p><strong><span>Regridding</span></strong></p><p><span>Make a gridfile (target.grid) of the form:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">gridtype &nbsp; = &nbsp; &nbsp; lonlat</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">xsize &nbsp; &nbsp;  = &nbsp; &nbsp; 500</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ysize &nbsp; &nbsp;  = &nbsp; &nbsp; 200</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">xfirst &nbsp; &nbsp; = &nbsp; &nbsp; 5.7</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">xinc &nbsp; &nbsp; &nbsp; = &nbsp; &nbsp; 0.01</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">yfirst &nbsp; &nbsp; = &nbsp; &nbsp; 45.70</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">yinc &nbsp; &nbsp; &nbsp; = &nbsp; &nbsp; 0.01</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><p><span>and run </span><code>cdo remapbil,target.grid input output</code><span>.</span></p><p><span>Industry Standard seems to be </span><code>remapcon</code><span> (conservative), </span><code>remapbil</code><span> is bilinear remapping.</span></p><p>&nbsp;</p><p><strong><span>Subset some variables into a new file</span></strong></p><p><span>To take a couple of variables and put it into a new file (e.g. if remapping fails due to errors related to single coordinates), you can run </span></p><pre lang="bash" class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">cdo select<span class="cm-def">,name</span><span class="cm-operator">=</span>ASWDIR_S,ATHD_S laf2019060702.nc out.nc</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>Example: get SW and LW in data from lafXX.nc files to put as boundary condition into the dynamic file.. Possible procedure goes as follows:</span></p><ul><li><p><span>For interesting timesteps: subset ASWDIR_S and ATHD_S to a separate file.</span></p></li><li><p><code>ncrcat 060{0702..0800}.nc jor1.nc</code><span> them together to one file with a time series.</span></p></li><li><p><span>remap the new file to a grid that equals the parent static driver extents with </span><code>cdo remapbil,grid.grid jor1.nc jor1rmp.nc</code><span>.</span></p></li><li><p><span>Use </span><code>xarray</code><span> to create an average over the spatial dimensions (</span><code>ds.ASWDIR_S.mean(dim=[lon&#39;,&#39;lat&#39;])</code><span>)</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; import xarray as xr</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; ds = xr.open_dataset('jor1rmp.nc')</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; ds</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&lt;xarray.Dataset&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Dimensions: &nbsp;  (lat: 60, lon: 80, time: 25)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Coordinates:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * time &nbsp; &nbsp; &nbsp; (time) datetime64[ns] 2019-06-07T02:00:00 ... 2019-06-08T02:00:00</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * lon &nbsp; &nbsp; &nbsp;  (lon) float64 6.563 6.564 6.565 6.566 ... 6.639 6.64 6.641 6.642</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * lat &nbsp; &nbsp; &nbsp;  (lat) float64 46.73 46.73 46.73 46.73 ... 46.78 46.78 46.78 46.79</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Data variables:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ASWDIFD_S  (time, lat, lon) float32 ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ATHD_S &nbsp; &nbsp; (time, lat, lon) float32 ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ASWDIR_S &nbsp; (time, lat, lon) float32 ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Attributes:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  CDI: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Climate Data Interface version 1.9.5 (http://mpimet.mpg....</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  Conventions: &nbsp; &nbsp; CF-1.6</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  history: &nbsp; &nbsp; &nbsp; &nbsp; Thu May 14 13:30:56 2020: cdo remapbil,grid.grid jor1b.n...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  source: &nbsp; &nbsp; &nbsp; &nbsp;  model: cosmo, production_status: unknown, version: 106, ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  institution: &nbsp; &nbsp; MeteoSwiss</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ConventionsURL:  http://cfconventions.org/cf-conventions/v1.6.0/cf-conven...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  NCO: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; netCDF Operators version 4.8.1 (Homepage = http://nco.sf...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  CDO: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Climate Data Operators version 1.9.5 (http://mpimet.mpg....</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; dsa = ds.mean(dim=['lon', 'lat'])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; dsa</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&lt;xarray.Dataset&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Dimensions: &nbsp;  (time: 25)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Coordinates:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * time &nbsp; &nbsp; &nbsp; (time) datetime64[ns] 2019-06-07T02:00:00 ... 2019-06-08T02:00:00</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Data variables:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ASWDIFD_S  (time) float32 0.0 0.0 1.1035653 19.519888 ... 0.0 0.0 0.0 0.0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ATHD_S &nbsp; &nbsp; (time) float32 346.2963 339.63437 322.497 ... 352.97894 327.9394</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ASWDIR_S &nbsp; (time) float32 0.0 0.0 0.0034005991 5.844116 ... 0.0 0.0 0.0 0.0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; dsa.to_netcdf('joravg.nc')</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 782px;"></div><div class="CodeMirror-gutters" style="display: none; height: 782px;"></div></div></div></pre><p>&nbsp;</p></li><li><p><span>Add this time series to the dynamic driver with</span></p><pre lang="" class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">import xarray as xr</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">import numpy as np</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">import os</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">import matplotlib.pyplot as plt</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">os.chdir('C:\\Users\\Stefan Fluck\\Desktop\\')</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">dyn = xr.open_dataset('radtest_dynamic', decode_times = False)</span></pre></div><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">raddata = xr.open_dataset('joravg.nc')</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time_rad = dyn.time.values</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">lwdata = raddata.ATHD_S.values</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">swdirdata = raddata.ATHD_S.values</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">swdifdata = raddata.ATHD_S.values</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_lw_in = xr.DataArray(lwdata, dims = 'time_rad', coords={'time_rad':time_rad} )</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_sw_in = xr.DataArray(swdirdata, dims = 'time_rad', coords={'time_rad':time_rad} )</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_sw_in_dif = xr.DataArray(swdifdata, dims = 'time_rad', coords={'time_rad':time_rad} )</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_lw_in.attrs['long_name'] = 'longwave downdwelling radiation'</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_lw_in.attrs['lod'] = 1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_lw_in.attrs['units'] = 'Wm-2'</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_sw_in.attrs['long_name'] = 'shortwave downdwelling radiation'</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_sw_in.attrs['lod'] = 1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_sw_in.attrs['units'] = 'Wm-2'</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_sw_in_dif.attrs['long_name'] = 'shortwave diffuse downdwelling radiation'</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_sw_in_dif.attrs['lod'] = 1</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rad_sw_in_dif.attrs['units'] = 'Wm-2'</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">dyn['rad_lw_in'] = rad_lw_in</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">dyn['rad_sw_in'] = rad_sw_in</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">dyn['rad_sw_in_dif'] = rad_sw_in_dif</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">dyn.to_netcdf('radtest_withrad_dynamic')</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 782px;"></div><div class="CodeMirror-gutters" style="display: none; height: 782px;"></div></div></div></pre><p>&nbsp;</p></li></ul><p>&nbsp;</p><h2><a name="gis--gdal" class="md-header-anchor"></a><span>GIS / GDAL</span></h2><p><strong><span>Fill empty values in a raster with values from another raster</span></strong></p><p><span>Example: swissAlti3d data close to the swiss borders contains only empty values outside of swiss territory. Idea: fill those areas with data from coarser NASA SRTM data. Problem: inhomogeneous resolutions and CRS (swissAlti3D is LV95 and 2x2m, NASA SRTM is WGS84 and 30x20m around Switzerland).</span></p><p><span>How to:</span></p><ul><li><span>reproject NASA SRTM Dataset to LV95 (QGIS: Raster -&gt; Projections -&gt; Transform)</span></li><li><span>cut NASA SRTM Dataset to a bit larger than the swissAlti3D subset (QGIS: Raster -&gt; Extract -&gt; Cut Raster to Extents)</span></li><li><span>resample NASA SRTM Dataset to swissALTI3D-Resolution (QGIS: right click on layer -&gt; Save as -&gt; set Resolution in the correct boxes)</span></li><li><span>With installed QGIS: Open </span><em><span>osgeo4w shell</span></em><span>. Without: Install GDAL Command Line Tools under Windows, or do it in Linux</span></li><li><code>gdal_merge -o &lt;outfilename&gt; &lt;infile&gt; &lt;infile2&gt;</code><span> does the job. Here, the input files are being put on top of each other, later mentioned files are put on top of earlier ones. Resolution information comes from the first one. Output datatype is guessed from the file ending of the outfilename (.tif is your best bet). </span></li></ul><p><span>For every QGIS operation there is a gdal equivalent, multiple steps can be done with e.g. gdal_translate. The command line is mighty: why point at things in a GUI while you could simply say what you want to do.</span></p><p>&nbsp;</p><p>&nbsp;</p><hr /><div style="page-break-after: always; break-after: page;"></div><h1><a name="glossary" class="md-header-anchor"></a><span>Glossary</span></h1><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p></div>
</body>
</html>